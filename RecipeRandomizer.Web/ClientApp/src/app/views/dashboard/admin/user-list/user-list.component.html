<h1 class="h1 mt-3">Users</h1>
<p class="text-muted mb-4">List of all users</p>
<table class="table table-striped table-fixed" *ngIf="users">
    <thead>
    <tr>
        <th scope="col">ID</th>
        <th scope="col">Username</th>
        <th scope="col">Email</th>
        <th scope="col">Role</th>
        <th scope="col">Lock Status</th>
        <th scope="col">Locked by</th>
        <th scope="col">Locked On</th>
        <th scope="col"></th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let user of users">
        <td>{{user.id}}</td>
        <td>{{user.username}}</td>
        <td>{{user.email}}</td>
        <td>{{roles[user.role] | uppercase}}</td>
        <td>
            <i class="fas fa-lock text-danger" *ngIf="user.isLocked"></i>
            <i class="fas fa-unlock text-success" *ngIf="!user.isLocked"></i>
        </td>
        <td>{{user.lockedBy?.username || '---'}}</td>
        <td>{{(user.lockedOn | date: 'dd MMM y, H:mm') || '---'}}</td>
        <td>
            <button (click)="toggleUserLock(user)" class="btn btn-sm btn-warning mr-2" [disabled]="isToggling || currentUser.id === user.id" ngbTooltip="Lock out user">
                <span *ngIf="isToggling" class="spinner-border spinner-border-sm"></span>
                <i *ngIf="!isToggling && !user.isLocked" class="fas fa-lock"></i>
                <i *ngIf="!isToggling && user.isLocked" class="fas fa-unlock"></i>
            </button>
            <button (click)="deleteUser(user.id)" class="btn btn-sm btn-danger mr-2" [disabled]="isDeleting || currentUser.id === user.id" ngbTooltip="Delete user">
                <span *ngIf="isDeleting" class="spinner-border spinner-border-sm"></span>
                <i *ngIf="!isDeleting" class="fas fa-user-slash"></i>
            </button>
        </td>
    </tr>
    </tbody>
</table>
